# webservice_java_docker

Для запуска сервиса на машине должен быть установлен maven и jdk 11.

Интеграционные тесты находятся в папке: rest_app/src/test. Тесты можно запустить через IDE. 
Также тесты можно запустить через maven для этого необходимо убрать свойство в файле pom.xml <maven.test.skip>true</maven.test.skip> или изменить значение на false.

Docker-compose файлы и Dockerfile расположены в папке deploy.
Для автоматизации развертывания приложения с БД достаточно запустить скрипт start.sh в корне проекта.

При запуске скрипта start.sh собирается артефакт jar-файл (если ранее не был создан). При необходимости создаются папки в которых будут храниться данные БД Postgres. Запускается docker-compose файл, который создает 2 контейнера и внутреннюю сеть для взаимодействия. В первом контейнере запускается jar-файл(артефакт), используя внешний порт - 80 и внутренний порт - 8080. Во втором сервер БД Postgres. Первый контейнер зависит от второго, взаимодействуя с ним по внутренней сети через порт 5432.

Краткое описание скриптов в корне проекта:
stop.sh: приостановить работу всех контейнеров
remove_all.sh: остановить работу всех контейнеров и удалить их. Также удалить все образы докер, сохраненные данные БД и артефакт.
restart_all.sh: удалить все контейнеры, образы докер, данные БД и артефакт. Создать новые образы, папки и запустить контейнеры. Данный скрипт выполняет 2 других скрипта remove_all.sh и start.sh.